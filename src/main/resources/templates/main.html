<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Page</title>
</head>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

<style>
    table {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        width: 100%;
    }

    td, th {
        border: 1px solid #000;
        text-align: left;
        padding: 8px;
    }

    tr:nth-child(even) {
        background-color: #dddddd;
    }

    .error {
        color: red;
    }
</style>
<body>

<form th:action="@{/logout}" method="post">
    <input type="submit" value="Logout" />
</form><br>

<form th:action="@{/user}" method="get">
    <input type="submit" value="User Info" />
</form><br>

<h1>User List</h1>

<table class="table table-bordered table-striped">
    <thead>
    <tr>
        <th>ID</th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
        <th>Roles</th>
        <th>Edit</th>
        <th>Delete</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="user : ${users}">
        <td th:text="${user.id}"></td>
        <td th:text="${user.firstName}"></td>
        <td th:text="${user.lastName}"></td>
        <td th:text="${user.email}"></td>
        <td th:text="${user.roles}"></td>
        <td><button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editModal">  <!--th:href="@{/admin/edit(id=${user.id})}"-->Edit</button></td>
        <td><button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal">Delete</button></td>
    </tr>
    </tbody>
    <a th:href="@{/admin/add_user}">Add User</a>
</table>

<!--Edit Modal-->

<div class="modal" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Edit User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form th:action="@{/admin/edited(id=${id})}" th:method="post" th:object="${editUserForm}">
                    <div class="mb-3">
                        <label for="idEdit" class="col-form-label" >Id</label>
                        <input type="text" class="form-control" id="idEdit"  th:field="*{id}" disabled>
                    </div>
                    <div class="mb-3">
                        <label for="firstNameEdit" class="col-form-label" >First Name</label>
                        <input type="text" class="form-control" id="firstNameEdit">
                    </div>
                    <div class="mb-3">
                        <label for="lastNameEdit" class="col-form-label" >Last Name</label>
                        <input type="text" class="form-control" id="lastNameEdit">
                    </div>
                    <div class="mb-3">
                        <label for="emailEdit" class="col-form-label" >Email</label>
                        <input type="text" class="form-control" id="emailEdit">
                    </div>
                    <div class="mb-3">
                        <label for="passwordEdit" class="col-form-label" >Password</label>
                        <input type="password" class="form-control" id="passwordEdit">
                    </div>
                    <div class="mb-3">
                        <label for="rolesEdit" class="col-form-label" >Roles</label>
                        <select class="form-select" size="2" id="rolesEdit">
                            <option value="ADMIN">ADMIN</option>
                            <option value="USER">USER</option>
                        </select>
                    </div>
                </form>

                <!--                <form th:action="@{/admin/edited(id=${id})}" th:method="post" th:object="${editUserForm}">-->
                <!--                    <a>Id : </a><a th:text="${id}"></a><br>-->
                <!--                    <div>-->
                <!--                        <label for="id">Id</label><br>-->
                <!--                        <input type="text"  th:field="*{id}" th:disabled>-->
                <!--                    </div>-->
                <!--                    <div>-->
                <!--                        <label for="firstName">First Name</label><br>-->
                <!--                        <input type="text" placeholder="e.g. John" th:field="*{firstName}">-->
                <!--                        <p th:if="${#fields.hasErrors('firstName')}" th:errorclass="error" th:errors="*{firstName}"></p>-->
                <!--                    </div>-->
                <!--                    <div>-->
                <!--                        <label for="lastName">Last Name</label><br>-->
                <!--                        <input type="text" placeholder="e.g. Doe" th:field="*{lastName}">-->
                <!--                        <p th:if="${#fields.hasErrors('lastName')}" th:errorclass="error" th:errors="*{lastName}"></p>-->
                <!--                    </div>-->
                <!--                    <div>-->
                <!--                        <label for="email">Email</label><br>-->
                <!--                        <input type="email" placeholder="e.g. john_doe@mail.com" th:field="*{email}">-->
                <!--                        <p th:if="${#fields.hasErrors('email')}" th:errorclass="error" th:errors="*{email}"></p>-->
                <!--                    </div>-->
                <!--                    <div>-->
                <!--                        <label for="password">Password</label><br>-->
                <!--                        <input type="password" th:field="*{password}">-->
                <!--                        <p th:if="${#fields.hasErrors('password')}" th:errorclass="error" th:errors="*{password}"></p>-->
                <!--                    </div>-->
                <!--                    <div>-->
                <!--                        <label>Roles:-->
                <!--                            <input type="checkbox" name="roles"-->
                <!--                                   th:each="role : ${allRoles}"-->
                <!--                                   th:text="${role.role}"-->
                <!--                                   th:value="${role.id}"-->
                <!--                                   th:field="*{roles}"-->
                <!--                            />-->
                <!--                        </label>-->
                <!--                        <p th:if="${#fields.hasErrors('roles')}" th:errorclass="error" th:errors="*{roles}"></p>-->
                <!--                    </div>-->
                <!--                    <br>-->
                <!--                    <button type="submit">Edit User</button>-->
                <!--                </form>-->

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Edit</button>
            </div>
        </div>
    </div>
</div>

<!--Delete Modal-->
<div class="modal" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">Delete User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form th:action="@{/admin/delete(id=${id})}" th:method="post" th:object="${editUserForm}">
                    <div class="mb-3">
                        <label for="idEdit" class="col-form-label" >Id</label>
                        <input type="text" class="form-control" id="idDelete" disabled="*{id}">
                    </div>
                    <div class="mb-3">
                        <label for="firstNameEdit" class="col-form-label" >First Name</label>
                        <input type="text" class="form-control" id="firstNameDelete" disabled="*{firstName}">
                    </div>
                    <div class="mb-3">
                        <label for="lastNameEdit" class="col-form-label" >Last Name</label>
                        <input type="text" class="form-control" id="lastNameDelete" disabled="*{lastName}">
                    </div>
                    <div class="mb-3">
                        <label for="emailEdit" class="col-form-label" >Email</label>
                        <input type="text" class="form-control" id="emailDelete" disabled="*{email}">
                    </div>
                    <div class="mb-3">
                        <label for="passwordEdit" class="col-form-label" >Password</label>
                        <input type="password" class="form-control" id="passwordDelete" disabled="">
                    </div>
                    <div class="mb-3">
                        <label for="rolesEdit" class="col-form-label" >Roles</label>
                        <select class="form-select" size="2" id="rolesDelete" disabled="*{roles}">
                            <option value="ADMIN">ADMIN</option>
                            <option value="USER">USER</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-danger">Delete</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>